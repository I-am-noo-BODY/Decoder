<script>

let currentType = "";
let language = "en";

const translations = {
    en: {
        title:"Password Strength Simulator",
        numeric:"Numeric Only",
        alpha:"Alphabetical",
        symbol:"Symbols Only",
        mixed:"Mixed",
        password:"Enter password",
        speed:"Guesses per second",
        calculate:"Calculate",
        reset:"Reset",
        back:"Back",
        total:"Total combinations:",
        time:"Estimated time:"
    },
    zh: {
        title:"密码强度模拟器",
        numeric:"仅数字",
        alpha:"仅字母",
        symbol:"仅符号",
        mixed:"混合",
        password:"输入密码",
        speed:"每秒猜测次数",
        calculate:"计算",
        reset:"重置",
        back:"返回",
        total:"总组合数:",
        time:"预计时间:"
    }
};

function applyLanguage() {
    document.querySelectorAll("[data-key]").forEach(el => {
        const key = el.getAttribute("data-key");
        if (translations[language][key]) {
            el.innerText = translations[language][key];
        }
    });

    document.getElementById("password").placeholder = translations[language].password;
    document.getElementById("speed").placeholder = translations[language].speed;
}

function toggleLang(){
    language = language === "en" ? "zh" : "en";
    applyLanguage();
}

function openDecoder(type){
    currentType = type;
    document.getElementById("mainMenu").style.display="none";
    document.getElementById("decoder").style.display="flex";
}

function goBack(){
    document.getElementById("decoder").style.display="none";
    document.getElementById("mainMenu").style.display="flex";
}

function resetFields(){
    document.getElementById("password").value="";
    document.getElementById("speed").value="";
    document.getElementById("result").innerText="";
}

document.getElementById("password").addEventListener("input", function(){
    let value = this.value;

    if(currentType==="numeric"){
        this.value = value.replace(/[^0-9]/g,'');
    }
    if(currentType==="alpha"){
        this.value = value.replace(/[^a-zA-Z]/g,'');
    }
    if(currentType==="symbol"){
        this.value = value.replace(/[a-zA-Z0-9]/g,'');
    }
});

function calculate(){

    const password = document.getElementById("password").value;
    const speed = Number(document.getElementById("speed").value);
    const length = password.length;

    if(!password || !speed) return;

    let charset = 0;

    if(currentType==="numeric") charset = 10;
    if(currentType==="alpha") charset = 52;
    if(currentType==="symbol") charset = 32;
    if(currentType==="mixed") charset = 94;

    const combinations = Math.pow(charset,length);
    const seconds = combinations/speed;

    document.getElementById("result").innerText =
        translations[language].total + " " + combinations.toLocaleString() + "\n\n" +
        translations[language].time + " " + seconds.toLocaleString() + " s";
}

applyLanguage();

</script>
